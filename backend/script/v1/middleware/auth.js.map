{"version":3,"sources":["../../../api/v1/middleware/auth.js"],"names":["jwt","require","module","exports","req","res","next","token","headers","authorization","split","decodedToken","verify","userId","body","status","json","error","Error"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AACnC,MAAI;AACF,UAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAd;AACA,UAAMC,YAAY,GAAGX,GAAG,CAACY,MAAJ,CAAWL,KAAX,EAAkB,qBAAlB,CAArB;AACA,UAAMM,MAAM,GAAGF,YAAY,CAACE,MAA5B;;AACA,QAAIT,GAAG,CAACU,IAAJ,CAASD,MAAT,IAAmBT,GAAG,CAACU,IAAJ,CAASD,MAAT,KAAoBA,MAA3C,EAAmD;AACjD,YAAM,iBAAN;AACD,KAFD,MAEO;AACLP,MAAAA,IAAI;AACL;AACF,GATD,CASE,MAAM;AACND,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,MAAAA,KAAK,EAAE,IAAIC,KAAJ,CAAU,kBAAV;AADY,KAArB;AAGD;AACF,CAfD","sourcesContent":["const jwt = require('jsonwebtoken');\n\nmodule.exports = (req, res, next) => {\n  try {\n    const token = req.headers.authorization.split(' ')[1];\n    const decodedToken = jwt.verify(token, 'RANDOM_TOKEN_SECRET');\n    const userId = decodedToken.userId;\n    if (req.body.userId && req.body.userId !== userId) {\n      throw 'Invalid user ID';\n    } else {\n      next();\n    }\n  } catch {\n    res.status(401).json({\n      error: new Error('Invalid request!')\n    });\n  }\n};"],"file":"auth.js"}